---
layout: post
title: Gradient Descent Optimization Algorithms 정리
categories : [Deep Learning]
tags : [Deep Learning, Gradient Descent, Optimization]
comments : true
---

<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>GRADIE~1.html</title>
  <meta name="generator" content="Haroopad 0.13.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
  body {
	overflow-x : hidden;
  }
  div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF);background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:5px -27px no-repeat #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:#FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:#EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:#75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:1px solid #1A3C6C;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin:0;max-width:none;min-height:0;outline:#112644 0;overflow-x:visible;overflow-y:visible;padding:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}.mermaid .label{color:#333}.node circle,.node polygon,.node rect{fill:#cde498;stroke:#13540c;stroke-width:1px}.edgePath .path{stroke:green;stroke-width:1.5px}.cluster rect{fill:#cdffb2;rx:40;stroke:#6eaa49;stroke-width:1px}.cluster text{fill:#333}.actor{stroke:#13540c;fill:#cde498}text.actor{fill:#000;stroke:none}.actor-line{stroke:grey}.messageLine0{stroke-width:1.5;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#333}.messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#arrowhead{fill:#333}#crosshead path{fill:#333!important;stroke:#333!important}.messageText{fill:#333;stroke:none}.labelBox{stroke:#326932;fill:#cde498}.labelText,.loopText{fill:#000;stroke:none}.loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#326932}.note{stroke:#6eaa49;fill:#fff5ad}.noteText{fill:#000;stroke:none;font-family:'trebuchet ms',verdana,arial;font-size:14px}.section{stroke:none;opacity:.2}.section0,.section2{fill:#6eaa49}.section1,.section3{fill:#fff;opacity:.2}.sectionTitle0,.sectionTitle1,.sectionTitle2,.sectionTitle3{fill:#333}.sectionTitle{text-anchor:start;font-size:11px;text-height:14px}.grid .tick{stroke:lightgrey;opacity:.3;shape-rendering:crispEdges}.grid path{stroke-width:0}.today{fill:none;stroke:red;stroke-width:2px}.task{stroke-width:2}.taskText{text-anchor:middle;font-size:11px}.taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}.taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}.taskText0,.taskText1,.taskText2,.taskText3{fill:#fff}.task0,.task1,.task2,.task3{fill:#487e3a;stroke:#13540c}.taskTextOutside0,.taskTextOutside1,.taskTextOutside2,.taskTextOutside3{fill:#000}.active0,.active1,.active2,.active3{fill:#cde498;stroke:#13540c}.activeText0,.activeText1,.activeText2,.activeText3{fill:#000!important}.done0,.done1,.done2,.done3{stroke:grey;fill:lightgrey;stroke-width:2}.doneText0,.doneText1,.doneText2,.doneText3{fill:#000!important}.crit0,.crit1,.crit2,.crit3{stroke:#f88;fill:red;stroke-width:2}.activeCrit0,.activeCrit1,.activeCrit2,.activeCrit3{stroke:#f88;fill:#cde498;stroke-width:2}.doneCrit0,.doneCrit1,.doneCrit2,.doneCrit3{stroke:#f88;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}.activeCritText0,.activeCritText1,.activeCritText2,.activeCritText3,.doneCritText0,.doneCritText1,.doneCritText2,.doneCritText3{fill:#000!important}.titleText{text-anchor:middle;font-size:18px;fill:#000}text{font-family:'trebuchet ms',verdana,arial;font-size:14px}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x;border:0;height:3px;padding:0}hr.underscore{border-top-style:dashed!important}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:url(../img/ajax.gif) center center no-repeat #fff}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}input.task-list-item{margin-left:-1.62em}.markdown{font-family:"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-wrap:break-word}.markdown pre{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;overflow:auto;padding:.5em}.markdown pre code{border:0;display:block}.markdown pre>code{font-family:Consolas,Inconsolata,Courier,monospace;font-weight:700;white-space:pre;margin:0}.markdown code{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown mark{color:#000;background-color:#fcf8e3}.markdown table{padding:0;border-collapse:collapse;border-spacing:0;margin-bottom:16px}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}@import url(http://fonts.googleapis.com/css?family=Roboto+Condensed:300italic,400italic,700italic,400,300,700);.haroopad{padding:20px;color:#222;font-size:15px;font-family:"Roboto Condensed",Tauri,"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;background:#fff;line-height:1.6;-webkit-font-smoothing:antialiased}.haroopad a{color:#3269a0}.haroopad a:hover{color:#4183c4}.haroopad h2{border-bottom:1px solid #e6e6e6}.haroopad h6{color:#777}.haroopad hr{border:1px solid #e6e6e6}.haroopad blockquote>code,.haroopad h1>code,.haroopad h2>code,.haroopad h3>code,.haroopad h4>code,.haroopad h5>code,.haroopad h6>code,.haroopad li>code,.haroopad p>code,.haroopad td>code{font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;font-size:85%;background-color:rgba(0,0,0,.02);padding:.2em .5em;border:1px solid #efefef}.haroopad pre>code{font-size:1em;letter-spacing:-1px;font-weight:700}.haroopad blockquote{border-left:4px solid #e6e6e6;padding:0 15px;color:#777}.haroopad table{background-color:#fafafa}.haroopad table tr td,.haroopad table tr th{border:1px solid #e6e6e6}.haroopad table tr:nth-child(2n){background-color:#f2f2f2}.hljs{display:block;overflow-x:auto;padding:.5em;background:#fdf6e3;color:#657b83;-webkit-text-size-adjust:none}.diff .hljs-header,.hljs-comment,.hljs-doctype,.hljs-javadoc,.hljs-pi,.lisp .hljs-string{color:#93a1a1}.css .hljs-tag,.hljs-addition,.hljs-keyword,.hljs-request,.hljs-status,.hljs-winutils,.method,.nginx .hljs-title{color:#859900}.hljs-command,.hljs-dartdoc,.hljs-hexcolor,.hljs-link_url,.hljs-number,.hljs-phpdoc,.hljs-regexp,.hljs-rules .hljs-value,.hljs-string,.hljs-tag .hljs-value,.tex .hljs-formula{color:#2aa198}.css .hljs-function,.hljs-built_in,.hljs-chunk,.hljs-decorator,.hljs-id,.hljs-identifier,.hljs-localvars,.hljs-title,.vhdl .hljs-literal{color:#268bd2}.hljs-attribute,.hljs-class .hljs-title,.hljs-constant,.hljs-link_reference,.hljs-parent,.hljs-type,.hljs-variable,.lisp .hljs-body,.smalltalk .hljs-number{color:#b58900}.css .hljs-pseudo,.diff .hljs-change,.hljs-attr_selector,.hljs-cdata,.hljs-header,.hljs-pragma,.hljs-preprocessor,.hljs-preprocessor .hljs-keyword,.hljs-shebang,.hljs-special,.hljs-subst,.hljs-symbol,.hljs-symbol .hljs-string{color:#cb4b16}.hljs-deletion,.hljs-important{color:#dc322f}.hljs-link_label{color:#6c71c4}.tex .hljs-formula{background:#eee8d5}.MathJax_Hover_Frame{border-radius:.25em;-webkit-border-radius:.25em;-moz-border-radius:.25em;-khtml-border-radius:.25em;box-shadow:0 0 15px #83A;-webkit-box-shadow:0 0 15px #83A;-moz-box-shadow:0 0 15px #83A;-khtml-box-shadow:0 0 15px #83A;border:1px solid #A6D!important;display:inline-block;position:absolute}.MathJax_Hover_Arrow{position:absolute;width:15px;height:11px;cursor:pointer}#MathJax_About{position:fixed;left:50%;width:auto;text-align:center;border:3px outset;padding:1em 2em;background-color:#DDD;color:#000;cursor:default;font-family:message-box;font-size:120%;font-style:normal;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px;-khtml-border-radius:15px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_Menu{position:absolute;background-color:#fff;color:#000;width:auto;padding:2px;border:1px solid #CCC;margin:0;cursor:default;font:menu;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_MenuItem{padding:2px 2em;background:0 0}.MathJax_MenuArrow{position:absolute;right:.5em;color:#666}.MathJax_MenuActive .MathJax_MenuArrow{color:#fff}.MathJax_MenuArrow.RTL{left:.5em;right:auto}.MathJax_MenuCheck{position:absolute;left:.7em}.MathJax_MenuCheck.RTL{right:.7em;left:auto}.MathJax_MenuRadioCheck{position:absolute;left:1em}.MathJax_MenuRadioCheck.RTL{right:1em;left:auto}.MathJax_MenuLabel{padding:2px 2em 4px 1.33em;font-style:italic}.MathJax_MenuRule{border-top:1px solid #CCC;margin:4px 1px 0}.MathJax_MenuDisabled{color:GrayText}.MathJax_MenuActive{background-color:Highlight;color:HighlightText}.MathJax_Menu_Close{position:absolute;width:31px;height:31px;top:-15px;left:-15px}#MathJax_Zoom{position:absolute;background-color:#F0F0F0;overflow:auto;display:block;z-index:301;padding:.5em;border:1px solid #000;margin:0;font-weight:400;font-style:normal;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;box-shadow:5px 5px 15px #AAA;-webkit-box-shadow:5px 5px 15px #AAA;-moz-box-shadow:5px 5px 15px #AAA;-khtml-box-shadow:5px 5px 15px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}#MathJax_ZoomOverlay{position:absolute;left:0;top:0;z-index:300;display:inline-block;width:100%;height:100%;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_ZoomFrame{position:relative;display:inline-block;height:0;width:0}#MathJax_ZoomEventTrap{position:absolute;left:0;top:0;z-index:302;display:inline-block;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}.MathJax_Preview{color:#888}#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0;padding:2px 8px;z-index:102;color:#000;font-size:80%;width:auto;white-space:nowrap}#MathJax_MSIE_Frame{position:absolute;top:0;left:0;width:0;z-index:101;border:0;margin:0;padding:0}.MathJax_Error{color:#C00;font-style:italic}.MathJax_Display{text-align:center;margin:1em 0;position:relative;display:block!important;text-indent:0;max-width:none;max-height:none;min-width:0;min-height:0;width:100%}.MathJax .merror{background-color:#FF8;color:#C00;border:1px solid #C00;padding:1px 3px;font-style:normal;font-size:90%}.MathJax .MJX-monospace{font-family:monospace}.MathJax .MJX-sans-serif{font-family:sans-serif}#MathJax_Tooltip{background-color:InfoBackground;color:InfoText;border:1px solid #000;box-shadow:2px 2px 5px #AAA;-webkit-box-shadow:2px 2px 5px #AAA;-moz-box-shadow:2px 2px 5px #AAA;-khtml-box-shadow:2px 2px 5px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true');padding:3px 4px;z-index:401;position:absolute;left:0;top:0;width:auto;height:auto;display:none}.MathJax{display:inline;font-style:normal;font-weight:400;line-height:normal;font-size:100%;font-size-adjust:none;text-indent:0;text-align:left;text-transform:none;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;direction:ltr;max-width:none;max-height:none;min-width:0;min-height:0;border:0;padding:0;margin:0}.MathJax a,.MathJax img,.MathJax nobr{border:0;padding:0;margin:0;max-width:5000em;max-height:5000em;min-width:0;min-height:0;vertical-align:0;line-height:normal;text-decoration:none}img.MathJax_strut{border:0!important;padding:0!important;margin:0!important;vertical-align:0!important}.MathJax span{display:inline;position:static;border:0;padding:0;margin:0;vertical-align:0;line-height:normal;text-decoration:none}.MathJax nobr{white-space:nowrap!important}.MathJax img{display:inline!important;float:none!important}.MathJax *{transition:none;-webkit-transition:none;-moz-transition:none;-ms-transition:none;-o-transition:none}.MathJax_Processing{visibility:hidden;position:fixed;width:0;height:0;overflow:hidden}.MathJax_Processed{display:none!important}.MathJax_ExBox{display:block!important;overflow:hidden;width:1px;height:60ex;min-height:0;max-height:none}.MathJax .MathJax_EmBox{display:block!important;overflow:hidden;width:1px;height:60em;min-height:0;max-height:none}.MathJax .MathJax_HitBox{cursor:text;background:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_Tooltip *,.MathJax .MathJax_HitBox *{filter:none;opacity:1;background:0 0}@font-face{font-family:MathJax_Main;src:url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Main;src:url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.4-beta-2) format('opentype');font-weight:700}@font-face{font-family:MathJax_Main;src:url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.4-beta-2) format('opentype');font-style:italic}@font-face{font-family:MathJax_Math;src:url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.4-beta-2) format('opentype');font-style:italic}@font-face{font-family:MathJax_Caligraphic;src:url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size1;src:url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size2;src:url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size3;src:url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size4;src:url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/Users/Beomsu/AppData/Roaming/Haroo%20Studio/Haroopad/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.4-beta-2) format('opentype')}.MathJax .noError{font-size:90%;text-align:left;color:#000;padding:1px 3px;border:1px solid}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown haroopad">
<h1 id="gradient-descent-optimization-algorithms-정리"><a name="gradient-descent-optimization-algorithms-정리" href="#gradient-descent-optimization-algorithms-정리"></a>Gradient Descent Optimization Algorithms 정리</h1><p>Neural network의 weight을 조절하는 과정에는 보통 <strong>‘Gradient Descent’</strong> 라는 방법을 사용한다. 이는 네트워크의 parameter들을 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.006em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">\theta</script></span>라고 했을 때, 네트워크에서 내놓는 결과값과 실제 결과값 사이의 차이를 정의하는 함수 Loss function <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-4" style="width: 2.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.913em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.435em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">J(\theta)</script></span>의 값을 최소화하기 위해 기울기(gradient) <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-10" style="width: 3.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.224em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.446em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="msubsup" id="MathJax-Span-12"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.831em 1000em 2.875em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="texatom" id="MathJax-Span-14"><span class="mrow" id="MathJax-Span-15"><span class="mi" id="MathJax-Span-16" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">\nabla_{\theta} J(\theta)</script></span>를 이용하는 방법이다. Gradient Descent에서는 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-21" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-22"><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.006em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4"> \theta </script></span> 에 대해 gradient의 반대 방향으로 일정 크기만큼 이동해내는 것을 반복하여 Loss function <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-5-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-24" style="width: 2.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.913em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.435em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-25"><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">J(\theta)</script></span> 의 값을 최소화하는 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-30" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-31"><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.006em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6"> \theta </script></span> 의 값을 찾는다. 한 iteration에서의 변화 식은 다음과 같다.</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-7-Frame"><nobr><span class="math" id="MathJax-Span-33" style="width: 8.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.213em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.457em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-34"><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">θ</span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="msubsup" id="MathJax-Span-40"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.831em 1000em 2.875em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-41" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="texatom" id="MathJax-Span-42"><span class="mrow" id="MathJax-Span-43"><span class="mi" id="MathJax-Span-44" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-48" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-7">\theta = \theta - \eta \nabla_{\theta} J(\theta)</script><p></p><p>이 때 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-8-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-49" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.853em 1000em 2.839em -0.471em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-50"><span class="mi" id="MathJax-Span-51" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.936em; vertical-align: -0.33em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8"> \eta </script></span> 는 미리 정해진 걸음의 크기 ‘step size’ 로서, 보통 0.01~0.001 정도의 적당한 크기를 사용한다.</p><p>이 때 Loss Function을 계산할 때 전체 train set을 사용하는 것을 <strong>Batch</strong> Gradient Descent 라고 한다. 그러나 이렇게 계산을 할 경우 한번 step을 내딛을 때 전체 데이터에 대해 Loss Function을 계산해야 하므로 너무 많은 계산량이 필요하다. 이를 방지하기 위해 보통은 <strong>Stochastic</strong> Gradient Descent (SGD) 라는 방법을 사용한다. 이 방법에서는 loss function을 계산할 때 전체 데이터(batch) 대신 일부 조그마한 데이터의 모음(mini-batch)에 대해서만 loss function을 계산한다. 이 방법은 batch gradient descent 보다 다소 부정확할 수는 있지만, 훨씬 계산 속도가 빠르기 때문에 같은 시간에 더 많은 step을 갈 수 있으며 여러 번 반복할 경우 보통 batch의 결과와 유사한 결과로 수렴한다. 또한, SGD를 사용할 경우 Batch Gradient Descent에서 빠질 local minima에 빠지지 않고 더 좋은 방향으로 수렴할 가능성도 있다.</p><p>보통 Neural Network를 트레이닝할 때는 이 SGD를 이용한다. 그러나 단순한 SGD를 이용하여 네트워크를 학습시키는 것에는 한계가 있다. 결론부터 살펴보기 위해, 다음과 같은 그림들을 살펴보자.</p><center><br><img src="http://i.imgur.com/2dKCQHh.gif?1" alt="Long Valley"><br>Gradient Descent Optimization Algorithms at Long Valley<br><br><img src="http://i.imgur.com/pD0hWu5.gif?1" alt="Beale's Function"><br>Gradient Descent Optimization Algorithms at Beale’s Function<br><br><img src="http://i.imgur.com/NKsFHJb.gif?1" alt="Saddle Point"><br>Gradient Descent Optimization Algorithms at Saddle Point<br></center><p>위의 그림들은 각각 SGD 및 SGD의 변형 알고리즘들이 최적값을 찾는 과정을 시각화한 것이다. 빨간색의 SGD가 우리가 알고 있는 Naive Stochastic Gradient Descent 알고리즘이고, Momentum, NAG, Adagrad, AdaDelta, RMSprop 등은 SGD의 변형이다. 보다시피 모든 경우에서 SGD는 다른 알고리즘들에 비해 성능이 월등하게 낮다. 다른 알고리즘들 보다 이동속도가 현저하게 느릴뿐만 아니라, 방향을 제대로 잡지 못하고 이상한 곳에서 수렴하여 이동하지 못하는 모습도 관찰할 수 있다. 즉 단순한 SGD를 이용하여 네트워크를 학습시킬 경우 네트워크가 상대적으로 좋은 결과를 얻지 못할 것이라고 예측할 수 있다. 그렇다면 실제로는 어떤 방법들을 이용해야 하는 것인가? 이 글에서는 Neural Network를 학습시킬 때 실제로 많이 사용하는 다양한 SGD의 변형 알고리즘들을 간략하게 살펴보겠다. 내용과 그림의 상당 부분은 <a href="http://sebastianruder.com/optimizing-gradient-descent/">Sebastian Ruder의 글</a> 에서 차용했다.</p><h2 id="momentum"><a name="momentum" href="#momentum"></a>Momentum</h2><p>Momentum 방식은 말 그대로 Gradient Descent를 통해 이동하는 과정에 일종의 ‘관성’을 주는 것이다. 현재 Gradient를 통해 이동하는 방향과는 별개로, 과거에 이동했던 방식을 기억하면서 그 방향으로 일정 정도를 추가적으로 이동하는 방식이다. 수식으로 표현하면 다음과 같다. <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-52" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.579em 1000em 2.508em -0.471em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-53"><span class="msubsup" id="MathJax-Span-54"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-56" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.866em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">v_t</script></span>를 time step t에서의 이동 벡터라고 할 때, 다음과 같은 식으로 이동을 표현할 수 있다.</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-10-Frame"><nobr><span class="math" id="MathJax-Span-57" style="width: 11.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.454em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.471em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-58"><span class="msubsup" id="MathJax-Span-59"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-61" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-64"><span style="display: inline-block; position: relative; width: 1.769em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.492em;"><span class="texatom" id="MathJax-Span-66"><span class="mrow" id="MathJax-Span-67"><span class="mi" id="MathJax-Span-68" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-69" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-70" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-72" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="msubsup" id="MathJax-Span-73"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.831em 1000em 2.875em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="texatom" id="MathJax-Span-75"><span class="mrow" id="MathJax-Span-76"><span class="mi" id="MathJax-Span-77" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">v_t = \gamma v_{t-1} + \eta \nabla_{\theta}J(\theta)</script><p></p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-11-Frame"><nobr><span class="math" id="MathJax-Span-82" style="width: 5.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.317em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.809em 1000em 2.999em -0.457em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-83"><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-86" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">θ</span><span class="mo" id="MathJax-Span-87" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-88" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.186em; vertical-align: -0.259em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">\theta = \theta - v_t</script><p></p><p>이 때, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-91" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.854em 1000em 2.839em -0.481em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-92"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.935em; vertical-align: -0.33em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12"> \gamma </script></span>는 얼마나 momentum을 줄 것인지에 대한 momentum term으로서, 보통 0.9 정도의 값을 사용한다.<br>식을 살펴보면 과거에 얼마나 이동했는지에 대한 이동 항 v를 기억하고, 새로운 이동항을 구할 경우 과거에 이동했던 정도에 관성항만큼 곱해준 후 Gradient을 이용한 이동 step 항을 더해준다. 이렇게 할 경우 이동항 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-94" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.579em 1000em 2.508em -0.471em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-95"><span class="msubsup" id="MathJax-Span-96"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-98" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.866em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13"> v_t </script></span> 는 다음과 같은 방식으로 정리할 수 있어, Gradient들의 지수평균을 이용하여 이동한다고도 해석할 수 있다.</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-14-Frame"><nobr><span class="math" id="MathJax-Span-99" style="width: 27.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.787em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.63em 1000em 3.135em -0.471em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-100"><span class="msubsup" id="MathJax-Span-101"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-103" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-104" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-105" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="msubsup" id="MathJax-Span-106"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.831em 1000em 2.875em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-107" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="texatom" id="MathJax-Span-108"><span class="mrow" id="MathJax-Span-109"><span class="mi" id="MathJax-Span-110" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-113" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="msubsup" id="MathJax-Span-114"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.437em); top: -2.678em; left: 0em;"><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.01em; left: 0.437em;"><span class="mi" id="MathJax-Span-116" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="msubsup" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.831em 1000em 2.875em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="texatom" id="MathJax-Span-122"><span class="mrow" id="MathJax-Span-123"><span class="mi" id="MathJax-Span-124" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="msubsup" id="MathJax-Span-128"><span style="display: inline-block; position: relative; width: 1.714em; height: 0px;"><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.437em); top: -2.678em; left: 0em;"><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.064em; left: 0.437em;"><span class="texatom" id="MathJax-Span-130"><span class="mrow" id="MathJax-Span-131"><span class="mi" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-136" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(1.854em 1000em 2.839em -0.481em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.763em; left: 0.604em;"><span class="mn" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span><span class="mi" id="MathJax-Span-139" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="msubsup" id="MathJax-Span-140"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.831em 1000em 2.875em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="texatom" id="MathJax-Span-142"><span class="mrow" id="MathJax-Span-143"><span class="mi" id="MathJax-Span-144" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-146" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-147" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="msubsup" id="MathJax-Span-148"><span style="display: inline-block; position: relative; width: 1.714em; height: 0px;"><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.437em); top: -2.678em; left: 0em;"><span class="mo" id="MathJax-Span-149" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.064em; left: 0.437em;"><span class="texatom" id="MathJax-Span-150"><span class="mrow" id="MathJax-Span-151"><span class="mi" id="MathJax-Span-152" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-153" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-154" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span><span class="mo" id="MathJax-Span-155" style="font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-157" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-159" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.569em; vertical-align: -0.424em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-14">v_t = \eta \nabla_{\theta}J(\theta)_t + \gamma \eta \nabla_{\theta}J(\theta)_{t-1} +\gamma^2 \eta \nabla_{\theta}J(\theta)_{t-2} + ....</script><p></p><p>Momentum 방식은 SGD가 Oscilation 현상을 겪을 때 더욱 빛을 발한다. 다음과 같이 SGD가 Oscilation을 겪고 있는 상황을 살펴보자.</p><center><br><img src="http://sebastianruder.com/content/images/2015/12/without_momentum.gif" alt="Oscilation"><br></center><p>현재 SGD는 중앙의 최적점으로 이동해야하는 상황인데, 한번의 step에서 움직일 수 있는 step size는 한계가 있으므로 이러한 oscilation 현상이 일어날 때는 좌우로 계속 진동하면서 이동에 난항을 겪게 된다.</p><center><br><img src="http://sebastianruder.com/content/images/2015/12/with_momentum.gif" alt="Momentum Oscilation"><br></center><p>그러나 Momentum 방식을 사용할 경우 다음과 같이 자주 이동하는 방향에 관성이 걸리게 되고, 진동을 하더라도 중앙으로 가는 방향에 힘을 얻기 때문에 SGD에 비해 상대적으로 빠르게 이동할 수 있다.</p><center><br><img src="http://www.yaldex.com/game-development/FILES/17fig09.gif" alt="Local Minimum Avoid"><br>Avoiding Local Minima. Picture from <a href="http://www.yaldex.com">http://www.yaldex.com</a>.<br></center><p>또한 Momentum 방식을 이용할 경우 위의 그림과 같이 local minima를 빠져나오는 효과가 있을 것이라고도 기대할 수 있다. 기존의 SGD를 이용할 경우 좌측의 local minima에 빠지면 gradient가 0이 되어 이동할 수가 없지만, momentum 방식의 경우 기존에 이동했던 방향에 관성이 있어 이 local minima를 빠져나오고 더 좋은 minima로 이동할 것을 기대할 수 있게 된다.<br>반면 momentum 방식을 이용할 경우 기존의 변수들 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-15-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-160" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-161"><span class="mi" id="MathJax-Span-162" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.006em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">\theta</script></span> 외에도 과거에 이동했던 양을 변수별로 저장해야하므로 변수에 대한 메모리가 기존의 두 배로 필요하게 된다.</p><h2 id="nesterov-accelerated-gradient-(nag)"><a name="nesterov-accelerated-gradient-(nag)" href="#nesterov-accelerated-gradient-(nag)"></a>Nesterov Accelerated Gradient (NAG)</h2><p>Nesterov Accelerated Gradient(NAG)는 Momentum 방식을 기초로 한 방식이지만, Gradient를 계산하는 방식이 살짝 다르다. 빠른 이해를 위해 다음 그림을 먼저 살펴보자.</p><center><br><img src="http://cs231n.github.io/assets/nn3/nesterov.jpeg" alt="Diff. between Momentum / NAG"><br>Difference between Momentum and NAG. Picture from CS231.<br></center><p>Momentum 방식에서는 이동 벡터 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-163" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.579em 1000em 2.508em -0.471em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-164"><span class="msubsup" id="MathJax-Span-165"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-166" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-167" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.866em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">v_t</script></span> 를 계산할 때 현재 위치에서의 gradient와 momentum step을 독립적으로 계산하고 합친다. 반면, NAG에서는 momentum step을 먼저 고려하여, momentum step을 먼저 이동했다고 생각한 후 그 자리에서의 gradient를 구해서 gradient step을 이동한다. 이를 수식으로 나타내면 다음과 같다.</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-17-Frame"><nobr><span class="math" id="MathJax-Span-168" style="width: 15.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.951em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.471em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-169"><span class="msubsup" id="MathJax-Span-170"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-172" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-173" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-174" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-175"><span style="display: inline-block; position: relative; width: 1.769em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.492em;"><span class="texatom" id="MathJax-Span-177"><span class="mrow" id="MathJax-Span-178"><span class="mi" id="MathJax-Span-179" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-180" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-181" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-183" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="msubsup" id="MathJax-Span-184"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.831em 1000em 2.875em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="texatom" id="MathJax-Span-186"><span class="mrow" id="MathJax-Span-187"><span class="mi" id="MathJax-Span-188" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-189" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-190" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-192" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-194"><span style="display: inline-block; position: relative; width: 1.769em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.492em;"><span class="texatom" id="MathJax-Span-196"><span class="mrow" id="MathJax-Span-197"><span class="mi" id="MathJax-Span-198" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-199" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-200" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span><span class="mo" id="MathJax-Span-201" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">v_t = \gamma v_{t-1}+ \eta\nabla_{\theta}J(\theta-\gamma v_{t-1})</script><p></p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-18-Frame"><nobr><span class="math" id="MathJax-Span-202" style="width: 5.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.317em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.809em 1000em 2.999em -0.457em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-203"><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-206" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">θ</span><span class="mo" id="MathJax-Span-207" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-208" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-210" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.186em; vertical-align: -0.259em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-18">\theta = \theta - v_t</script><p></p><p>NAG를 이용할 경우 Momentum 방식에 비해 보다 효과적으로 이동할 수 있다. Momentum 방식의 경우 멈춰야 할 시점에서도 관성에 의해 훨씬 멀리 갈수도 있다는 단점이 존재하는 반면, NAG 방식의 경우 일단 모멘텀으로 이동을 반정도 한 후 어떤 방식으로 이동해야할 지를 결정한다. 따라서 Momentum 방식의 빠른 이동에 대한 이점은 누리면서도, 멈춰야 할 적절한 시점에서 제동을 거는 데에 훨씬 용이하다고 생각할 수 있을 것이다.</p><h2 id="adagrad"><a name="adagrad" href="#adagrad"></a>Adagrad</h2><p>Adagrad(Adaptive Gradient)는 변수들을 update할 때 각각의 변수마다 step size를 다르게 설정해서 이동하는 방식이다. 이 알고리즘의 기본적인 아이디어는 ‘지금까지 많이 변화하지 않은 변수들은 step size를 크게 하고, 지금까지 많이 변화했던 변수들은 step size를 작게 하자’ 라는 것이다. 자주 등장하거나 변화를 많이 한 변수들의 경우 optimum에 가까이 있을 확률이 높기 때문에 작은 크기로 이동하면서 세밀한 값을 조정하고, 적게 변화한 변수들은 optimum 값에 도달하기 위해서는 많이 이동해야할 확률이 높기 때문에 먼저 빠르게 loss 값을 줄이는 방향으로 이동하려는 방식이라고 생각할 수 있겠다. 특히 word2vec이나 GloVe 같이 word representation을 학습시킬 경우 단어의 등장 확률에 따라 variable의 사용 비율이 확연하게 차이나기 때문에 Adagrad와 같은 학습 방식을 이용하면 훨씬 더 좋은 성능을 거둘 수 있을 것이다.</p><p>Adagrad의 한 스텝을 수식화하여 나타내면 다음과 같다.</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-19-Frame"><nobr><span class="math" id="MathJax-Span-211" style="width: 13.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.71em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.566em 1000em 3.092em -0.442em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-212"><span class="msubsup" id="MathJax-Span-213"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.645em -0.442em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.82em;"><span class="texatom" id="MathJax-Span-215"><span class="mrow" id="MathJax-Span-216"><span class="mi" id="MathJax-Span-217" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-218" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-219" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.097em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.645em -0.442em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-220" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.82em;"><span class="texatom" id="MathJax-Span-221"><span class="mrow" id="MathJax-Span-222"><span class="mi" id="MathJax-Span-223" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-224" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-225" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-227" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="msubsup" id="MathJax-Span-228"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.831em 1000em 2.875em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="texatom" id="MathJax-Span-230"><span class="mrow" id="MathJax-Span-231"><span class="mi" id="MathJax-Span-232" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-233" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-235"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-237" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-239"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.437em); top: -2.678em; left: 0em;"><span class="mo" id="MathJax-Span-240" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.827em; left: 0.437em;"><span class="mn" id="MathJax-Span-241" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.595em; vertical-align: -0.372em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-19">G_{t} = G_{t-1} + (\nabla_{\theta}J(\theta_t))^2</script><p></p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-20-Frame"><nobr><span class="math" id="MathJax-Span-242" style="width: 16.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.661em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.379em 1000em 4.028em -0.457em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-243"><span class="msubsup" id="MathJax-Span-244"><span style="display: inline-block; position: relative; width: 1.769em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.492em;"><span class="texatom" id="MathJax-Span-246"><span class="mrow" id="MathJax-Span-247"><span class="mi" id="MathJax-Span-248" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-249" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-250" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span><span class="mo" id="MathJax-Span-251" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-252" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-254" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-255" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mfrac" id="MathJax-Span-256" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 3.97em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.853em 1000em 2.839em -0.471em); top: -3.152em; left: 50%; margin-left: -0.273em;"><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; clip: rect(2.933em 1000em 4.471em -0.381em); top: -3.12em; left: 50%; margin-left: -1.925em;"><span class="msqrt" id="MathJax-Span-258"><span style="display: inline-block; position: relative; width: 3.85em; height: 0px;"><span style="position: absolute; clip: rect(1.809em 1000em 2.999em -0.442em); top: -2.678em; left: 0.984em;"><span class="mrow" id="MathJax-Span-259"><span class="msubsup" id="MathJax-Span-260"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.645em -0.442em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-261" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.82em;"><span class="mi" id="MathJax-Span-262" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-263" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; clip: rect(3.555em 1000em 4.023em -0.492em); top: -4.611em; left: 0.984em;"><span style="display: inline-block; position: relative; width: 2.867em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: 2.173em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 0.461em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 1.032em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 1.602em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(2.975em 1000em 4.503em -0.381em); top: -4.021em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 3.97em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-266" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.831em 1000em 2.875em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="texatom" id="MathJax-Span-268"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-271" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-272" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-273"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-274" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-275" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-276" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.965em; vertical-align: -1.514em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-20">\theta_{t+1} = \theta_t - \frac{\eta}{\sqrt{G_t + \epsilon}} \cdot \nabla_{\theta}J(\theta_t)</script><p></p><p>Neural Network의 parameter가 k개라고 할 때, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-277" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.508em -0.442em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-278"><span class="msubsup" id="MathJax-Span-279"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.645em -0.442em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.82em;"><span class="mi" id="MathJax-Span-281" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.186em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">G_t</script></span>는 k차원 벡터로서 ‘time step t까지 각 변수가 이동한 gradient의 sum of squares’ 를 저장한다. <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-282" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-283"><span class="mi" id="MathJax-Span-284" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.006em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22"> \theta </script></span>를 업데이트하는 상황에서는 기존 step size <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-23-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-285" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.853em 1000em 2.839em -0.471em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-286"><span class="mi" id="MathJax-Span-287" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.936em; vertical-align: -0.33em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">\eta</script></span>에 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-24-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-288" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.508em -0.442em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-289"><span class="msubsup" id="MathJax-Span-290"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.645em -0.442em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-291" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.82em;"><span class="mi" id="MathJax-Span-292" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.186em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">G_t</script></span>의 루트값에 반비례한 크기로 이동을 진행하여, 지금까지 많이 변화한 변수일 수록 적게 이동하고 적게 변화한 변수일 수록 많이 이동하도록 한다. 이 때 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-25-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-293" style="width: 0.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.864em 1000em 2.634em -0.452em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-294"><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Math; font-style: italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.673em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">\epsilon</script></span>은 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-26-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-296" style="width: 2.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.077em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.15em 1000em 2.372em -0.409em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-297"><span class="msubsup" id="MathJax-Span-298"><span style="display: inline-block; position: relative; width: 2.042em; height: 0px;"><span style="position: absolute; clip: rect(1.848em 1000em 2.864em -0.409em); top: -2.678em; left: 0em;"><span class="mn" id="MathJax-Span-299" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.743em; left: 1.038em;"><span class="texatom" id="MathJax-Span-300"><span class="mrow" id="MathJax-Span-301"><span class="mo" id="MathJax-Span-302" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-303" style="font-size: 70.7%; font-family: MathJax_Main;">4</span></span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.224em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">10^{-4}</script></span> ~ <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-27-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-304" style="width: 2.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.077em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.158em 1000em 2.372em -0.409em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-305"><span class="msubsup" id="MathJax-Span-306"><span style="display: inline-block; position: relative; width: 2.042em; height: 0px;"><span style="position: absolute; clip: rect(1.848em 1000em 2.864em -0.409em); top: -2.678em; left: 0em;"><span class="mn" id="MathJax-Span-307" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.743em; left: 1.038em;"><span class="texatom" id="MathJax-Span-308"><span class="mrow" id="MathJax-Span-309"><span class="mo" id="MathJax-Span-310" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-311" style="font-size: 70.7%; font-family: MathJax_Main;">8</span></span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.214em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">10^{-8}</script></span> 정도의 작은 값으로서 0으로 나누는 것을 방지하기 위한 작은 값이다. 여기에서 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-28-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-312" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.508em -0.442em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-313"><span class="msubsup" id="MathJax-Span-314"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.645em -0.442em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-315" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.82em;"><span class="mi" id="MathJax-Span-316" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.186em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">G_t</script></span>를 업데이트하는 식에서 제곱은 element-wise 제곱을 의미하며, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-29-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-317" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-318"><span class="mi" id="MathJax-Span-319" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.006em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">\theta</script></span>를 업데이트하는 식에서도 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-30-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-320" style="width: 0.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.328em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.204em 1000em 2.652em -0.414em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-321"><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main;">⋅</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.28em; vertical-align: 0.165em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">\cdot</script></span> 은 element-wise한 연산을 의미한다.</p><p>Adagrad를 사용하면 학습을 진행하면서 굳이 step size decay등을 신경써주지 않아도 된다는 장점이 있다. 보통 adagrad에서 step size로는 0.01 정도를 사용한 뒤, 그 이후로는 바꾸지 않는다.<br>반면, Adagrad에는 학습을 계속 진행하면 step size가 너무 줄어든다는 문제점이 있다. <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-31-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-323" style="width: 1.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.59em 1000em 2.645em -0.442em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-324"><span class="mi" id="MathJax-Span-325" style="font-family: MathJax_Math; font-style: italic;">G</span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.02em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">G</script></span>에는 계속 제곱한 값을 넣어주기 때문에 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-32-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-326" style="width: 1.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.59em 1000em 2.645em -0.442em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-327"><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Math; font-style: italic;">G</span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.02em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">G</script></span>의 값들은 계속해서 증가하기 때문에, 학습이 오래 진행될 경우 step size가 너무 작아져서 결국 거의 움직이지 않게 된다. 이를 보완하여 고친 알고리즘이 RMSProp과 AdaDelta이다.</p><h2 id="rmsprop"><a name="rmsprop" href="#rmsprop"></a>RMSProp</h2><p>RMSProp은 딥러닝의 대가 제프리 힌톤이 제안한 방법으로서, Adagrad의 단점을 해결하기 위한 방법이다. Adagrad의 식에서 gradient의 제곱값을 더해나가면서 구한 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-33-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-329" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.508em -0.442em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-330"><span class="msubsup" id="MathJax-Span-331"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.645em -0.442em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-332" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.82em;"><span class="mi" id="MathJax-Span-333" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.186em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">G_t</script></span> 부분을 합이 아니라 지수평균으로 바꾸어서 대체한 방법이다. 이렇게 대체를 할 경우 Adagrad처럼 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-334" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.508em -0.442em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-335"><span class="msubsup" id="MathJax-Span-336"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.645em -0.442em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.82em;"><span class="mi" id="MathJax-Span-338" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.186em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">G_t</script></span>가 무한정 커지지는 않으면서 최근 변화량의 변수간 상대적인 크기 차이는 유지할 수 있다. 식으로 나타내면 다음과 같다.</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-35-Frame"><nobr><span class="math" id="MathJax-Span-339" style="width: 15.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.568em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.566em 1000em 3.092em -0.442em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-340"><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_Math; font-style: italic;">G</span><span class="mo" id="MathJax-Span-342" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-343" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-344" style="font-family: MathJax_Math; font-style: italic;">G</span><span class="mo" id="MathJax-Span-345" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-347" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-348" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-349" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mo" id="MathJax-Span-350" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-352"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.831em 1000em 2.875em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-353" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="texatom" id="MathJax-Span-354"><span class="mrow" id="MathJax-Span-355"><span class="mi" id="MathJax-Span-356" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-358" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-359"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-361" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-362" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-363"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.437em); top: -2.678em; left: 0em;"><span class="mo" id="MathJax-Span-364" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.827em; left: 0.437em;"><span class="mn" id="MathJax-Span-365" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.595em; vertical-align: -0.372em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-35">G = \gamma G + (1-\gamma)(\nabla_{\theta}J(\theta_t))^2</script><p></p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-36-Frame"><nobr><span class="math" id="MathJax-Span-366" style="width: 14.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.475em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.379em 1000em 3.827em -0.457em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-367"><span class="mi" id="MathJax-Span-368" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-369" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-370" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">θ</span><span class="mo" id="MathJax-Span-371" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mfrac" id="MathJax-Span-372" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 3.424em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.853em 1000em 2.839em -0.471em); top: -3.152em; left: 50%; margin-left: -0.273em;"><span class="mi" id="MathJax-Span-373" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; clip: rect(2.996em 1000em 4.333em -0.42em); top: -3.183em; left: 50%; margin-left: -1.652em;"><span class="msqrt" id="MathJax-Span-374"><span style="display: inline-block; position: relative; width: 3.304em; height: 0px;"><span style="position: absolute; clip: rect(1.809em 1000em 2.924em -0.442em); top: -2.678em; left: 0.82em;"><span class="mrow" id="MathJax-Span-375"><span class="mi" id="MathJax-Span-376" style="font-family: MathJax_Math; font-style: italic;">G</span><span class="mo" id="MathJax-Span-377" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; clip: rect(3.555em 1000em 4.023em -0.492em); top: -4.548em; left: 0.82em;"><span style="display: inline-block; position: relative; width: 2.484em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: 1.79em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 0.366em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 0.841em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 1.315em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(3.025em 1000em 4.353em -0.42em); top: -4.009em; left: 0em;"><span style="font-family: MathJax_Main;">√</span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 3.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-379" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-380" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.831em 1000em 2.875em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-381" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="texatom" id="MathJax-Span-382"><span class="mrow" id="MathJax-Span-383"><span class="mi" id="MathJax-Span-384" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-385" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-386" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-387"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-388" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-389" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-390" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.72em; vertical-align: -1.269em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-36">\theta = \theta - \frac{\eta}{\sqrt{G + \epsilon}} \cdot \nabla_{\theta}J(\theta_t)</script><p></p><h2 id="adadelta"><a name="adadelta" href="#adadelta"></a>AdaDelta</h2><p>AdaDelta (Adaptive Delta) 는 RMSProp과 유사하게 AdaGrad의 단점을 보완하기 위해 제안된 방법이다. AdaDelta는 RMSProp과 동일하게 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-37-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-391" style="width: 1.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.59em 1000em 2.645em -0.442em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-392"><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Math; font-style: italic;">G</span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.02em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">G</script></span>를 구할 때 합을 구하는 대신 지수평균을 구한다. 다만, 여기에서는 step size를 단순하게 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-38-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-394" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.546em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.853em 1000em 2.839em -0.471em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-395"><span class="mi" id="MathJax-Span-396" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.936em; vertical-align: -0.33em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">\eta</script></span> 로 사용하는 대신 step size의 변화값의 제곱을 가지고 지수평균 값을 사용한다.</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-39-Frame"><nobr><span class="math" id="MathJax-Span-397" style="width: 15.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.568em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.566em 1000em 3.092em -0.442em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-398"><span class="mi" id="MathJax-Span-399" style="font-family: MathJax_Math; font-style: italic;">G</span><span class="mo" id="MathJax-Span-400" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-402" style="font-family: MathJax_Math; font-style: italic;">G</span><span class="mo" id="MathJax-Span-403" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-404" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-405" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-406" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-409" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-410"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.831em 1000em 2.875em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="texatom" id="MathJax-Span-412"><span class="mrow" id="MathJax-Span-413"><span class="mi" id="MathJax-Span-414" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-415" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-416" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-417"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-418" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-419" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-420" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-421"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.437em); top: -2.678em; left: 0em;"><span class="mo" id="MathJax-Span-422" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.827em; left: 0.437em;"><span class="mn" id="MathJax-Span-423" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.595em; vertical-align: -0.372em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-39">G = \gamma G + (1-\gamma)(\nabla_{\theta}J(\theta_t))^2</script><p></p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-40-Frame"><nobr><span class="math" id="MathJax-Span-424" style="width: 13.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.656em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.029em 1000em 3.827em -0.446em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-425"><span class="msubsup" id="MathJax-Span-426"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.798em 1000em 2.842em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-427" style="font-family: MathJax_Main;">Δ</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="texatom" id="MathJax-Span-428"><span class="mrow" id="MathJax-Span-429"><span class="mi" id="MathJax-Span-430" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-431" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-432" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 3.424em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.058em 1000em 4.394em -0.42em); top: -4.706em; left: 50%; margin-left: -1.488em;"><span class="msqrt" id="MathJax-Span-433"><span style="display: inline-block; position: relative; width: 2.976em; height: 0px;"><span style="position: absolute; clip: rect(1.931em 1000em 2.924em -0.439em); top: -2.678em; left: 0.82em;"><span class="mrow" id="MathJax-Span-434"><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-436" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-437" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; clip: rect(3.555em 1000em 4.023em -0.492em); top: -4.487em; left: 0.82em;"><span style="display: inline-block; position: relative; width: 2.156em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: 1.462em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 0.415em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 0.938em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(3.025em 1000em 4.353em -0.42em); top: -3.948em; left: 0em;"><span style="font-family: MathJax_Main;">√</span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(2.996em 1000em 4.333em -0.42em); top: -3.183em; left: 50%; margin-left: -1.652em;"><span class="msqrt" id="MathJax-Span-438"><span style="display: inline-block; position: relative; width: 3.304em; height: 0px;"><span style="position: absolute; clip: rect(1.809em 1000em 2.924em -0.442em); top: -2.678em; left: 0.82em;"><span class="mrow" id="MathJax-Span-439"><span class="mi" id="MathJax-Span-440" style="font-family: MathJax_Math; font-style: italic;">G</span><span class="mo" id="MathJax-Span-441" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-442" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; clip: rect(3.555em 1000em 4.023em -0.492em); top: -4.548em; left: 0.82em;"><span style="display: inline-block; position: relative; width: 2.484em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: 1.79em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 0.366em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 0.841em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 1.315em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(3.025em 1000em 4.353em -0.42em); top: -4.009em; left: 0em;"><span style="font-family: MathJax_Main;">√</span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 3.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-443" style="font-family: MathJax_Main; padding-left: 0.222em;">⋅</span><span class="msubsup" id="MathJax-Span-444" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.831em 1000em 2.875em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-445" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="texatom" id="MathJax-Span-446"><span class="mrow" id="MathJax-Span-447"><span class="mi" id="MathJax-Span-448" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-449" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-450" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-451"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-452" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-453" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-454" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.147em; vertical-align: -1.269em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-40">\Delta_{\theta} =  \frac{\sqrt{s+\epsilon}}{\sqrt{G + \epsilon}} \cdot \nabla_{\theta}J(\theta_t)</script><p></p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-41-Frame"><nobr><span class="math" id="MathJax-Span-455" style="width: 5.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.809em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.798em 1000em 3.003em -0.457em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-456"><span class="mi" id="MathJax-Span-457" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-458" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-459" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">θ</span><span class="mo" id="MathJax-Span-460" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-461" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.798em 1000em 2.842em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-462" style="font-family: MathJax_Main;">Δ</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="texatom" id="MathJax-Span-463"><span class="mrow" id="MathJax-Span-464"><span class="mi" id="MathJax-Span-465" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.263em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-41">\theta = \theta - \Delta_{\theta}</script><p></p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-42-Frame"><nobr><span class="math" id="MathJax-Span-466" style="width: 10.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.415em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.6em 1000em 3.096em -0.439em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-467"><span class="mi" id="MathJax-Span-468" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-469" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-470" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-471" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-472" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-473" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-474" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-475" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-478"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.798em 1000em 2.842em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-479" style="font-family: MathJax_Main;">Δ</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; clip: rect(1.715em 1000em 2.514em -0.456em); top: -2.793em; left: 0.874em;"><span class="mn" id="MathJax-Span-480" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span><span style="position: absolute; clip: rect(1.633em 1000em 2.466em -0.467em); top: -2.048em; left: 0.874em;"><span class="texatom" id="MathJax-Span-481"><span class="mrow" id="MathJax-Span-482"><span class="mi" id="MathJax-Span-483" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.559em; vertical-align: -0.377em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-42">s = \gamma s + (1-\gamma) \Delta_{\theta}^2</script><p></p><p>얼핏 보면 왜 이러한 식이 도출되었는지 이해가 안될 수 있지만, 이는 사실 Gradient Descent와 같은 first-order optimization 대신 Second-order optimization을 approximate 하기 위한 방법이다. 실제로 <a href="http://www.matthewzeiler.com/pubs/googleTR2012/googleTR2012.pdf">논문</a>의 저자는 SGD, Momentum, Adagrad와 같은 식들의 경우 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-43-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-484" style="width: 1.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.311em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.798em 1000em 2.852em -0.446em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-485"><span class="mi" id="MathJax-Span-486" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-487" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.019em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-43"> \Delta \theta </script></span>의 unit(단위)을 구해보면 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-44-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-488" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-489"><span class="mi" id="MathJax-Span-490" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.006em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44">\theta</script></span>의 unit이 아니라 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-45-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-491" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-492"><span class="mi" id="MathJax-Span-493" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.006em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45">\theta</script></span>의 unit의 역수를 따른다는 것을 지적한다. <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-46-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-494" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.492em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.59em 1000em 2.633em -0.457em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-495"><span class="mi" id="MathJax-Span-496" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.006em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">\theta</script></span>의 unit을 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-47-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-497" style="width: 2.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.858em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.471em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-498"><span class="mi" id="MathJax-Span-499" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mo" id="MathJax-Span-500" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-501" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-502" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-47">u(\theta)</script></span>라고 하고 J는 unit이 없다고 생각할 경우, first-order optimization에서는</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-48-Frame"><nobr><span class="math" id="MathJax-Span-503" style="width: 9.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.76em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.122em 1000em 3.818em -0.446em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-504"><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-507" style="font-family: MathJax_Main; padding-left: 0.278em;">∝</span><span class="mfrac" id="MathJax-Span-508" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.322em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.799em 1000em 2.864em -0.45em); top: -3.354em; left: 50%; margin-left: -0.601em;"><span class="mrow" id="MathJax-Span-509"><span class="mi" id="MathJax-Span-510" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-511" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; clip: rect(1.799em 1000em 2.864em -0.45em); top: -1.986em; left: 50%; margin-left: -0.519em;"><span class="mrow" id="MathJax-Span-512"><span class="mi" id="MathJax-Span-513" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-514" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.322em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-515" style="font-family: MathJax_Main; padding-left: 0.278em;">∝</span><span class="mfrac" id="MathJax-Span-516" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.978em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.848em 1000em 2.842em -0.409em); top: -3.354em; left: 50%; margin-left: -0.273em;"><span class="mn" id="MathJax-Span-517" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.471em); top: -1.951em; left: 50%; margin-left: -0.929em;"><span class="mrow" id="MathJax-Span-518"><span class="mi" id="MathJax-Span-519" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mo" id="MathJax-Span-520" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-521" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-522" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.978em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.022em; vertical-align: -1.258em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-48">\Delta \theta \propto \frac{\partial J}{\partial \theta} \propto \frac{1}{u(\theta)}</script><p></p><p>이다. 반면, Newton method와 같은 second-order optimization을 생각해보면</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-49-Frame"><nobr><span class="math" id="MathJax-Span-523" style="width: 9.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.76em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.67em 1000em 4.458em -0.446em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-524"><span class="mi" id="MathJax-Span-525" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-527" style="font-family: MathJax_Main; padding-left: 0.278em;">∝</span><span class="mfrac" id="MathJax-Span-528" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.737em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(2.892em 1000em 4.587em -0.492em); top: -4.899em; left: 50%; margin-left: -0.617em;"><span class="mfrac" id="MathJax-Span-529"><span style="display: inline-block; position: relative; width: 0.994em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.68em 1000em 2.529em -0.462em); top: -2.778em; left: 50%; margin-left: -0.437em;"><span class="mrow" id="MathJax-Span-530"><span class="mi" id="MathJax-Span-531" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-532" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span><span style="position: absolute; clip: rect(1.68em 1000em 2.529em -0.462em); top: -1.932em; left: 50%; margin-left: -0.383em;"><span class="mrow" id="MathJax-Span-533"><span class="mi" id="MathJax-Span-534" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-535" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 0.994em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(2.752em 1000em 4.719em -0.492em); top: -2.939em; left: 50%; margin-left: -0.808em;"><span class="mfrac" id="MathJax-Span-536"><span style="display: inline-block; position: relative; width: 1.377em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.486em 1000em 2.475em -0.462em); top: -2.723em; left: 50%; margin-left: -0.628em;"><span class="mrow" id="MathJax-Span-537"><span class="msubsup" id="MathJax-Span-538"><span style="display: inline-block; position: relative; width: 0.821em; height: 0px;"><span style="position: absolute; clip: rect(1.68em 1000em 2.529em -0.462em); top: -2.35em; left: 0em;"><span class="mi" id="MathJax-Span-539" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span><span style="position: absolute; top: -2.498em; left: 0.495em;"><span class="mn" id="MathJax-Span-540" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span><span class="mi" id="MathJax-Span-541" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.547em 1000em 2.529em -0.462em); top: -1.799em; left: 50%; margin-left: -0.574em;"><span class="mrow" id="MathJax-Span-542"><span class="mi" id="MathJax-Span-543" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-544"><span style="display: inline-block; position: relative; width: 0.709em; height: 0px;"><span style="position: absolute; clip: rect(1.633em 1000em 2.466em -0.467em); top: -2.295em; left: 0em;"><span class="mi" id="MathJax-Span-545" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; top: -2.491em; left: 0.383em;"><span class="mn" id="MathJax-Span-546" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.377em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.737em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-547" style="font-family: MathJax_Main; padding-left: 0.278em;">∝</span><span class="mi" id="MathJax-Span-548" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">u</span><span class="mo" id="MathJax-Span-549" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-550" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-551" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.355em; vertical-align: -2.039em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-49">\Delta \theta \propto \frac{\frac{\partial J}{\partial \theta}}{\frac{\partial^2 J}{\partial \theta^2}} \propto u(\theta)</script><p></p><p>이므로 바른 unit을 가지게 된다. 따라서 저자는 Newton’s method를 이용하여 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-50-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-552" style="width: 1.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.311em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.798em 1000em 2.852em -0.446em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-553"><span class="mi" id="MathJax-Span-554" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-555" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.019em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-50">\Delta \theta</script></span>가 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-51-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-556" style="width: 2.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.749em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.547em 1000em 3.599em -0.492em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-557"><span class="mfrac" id="MathJax-Span-558"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.117em 1000em 4.507em -0.492em); top: -4.756em; left: 50%; margin-left: -0.481em;"><span class="mfrac" id="MathJax-Span-559"><span style="display: inline-block; position: relative; width: 0.721em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.664em 1000em 2.361em -0.471em); top: -2.536em; left: 50%; margin-left: -0.301em;"><span class="mrow" id="MathJax-Span-560"><span class="mi" id="MathJax-Span-561" style="font-size: 50%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mi" id="MathJax-Span-562" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span><span style="position: absolute; clip: rect(1.664em 1000em 2.361em -0.471em); top: -1.843em; left: 50%; margin-left: -0.273em;"><span class="mrow" id="MathJax-Span-563"><span class="mi" id="MathJax-Span-564" style="font-size: 50%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mi" id="MathJax-Span-565" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.24em; left: 0em;"><span style="border-left-width: 0.721em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(2.977em 1000em 4.642em -0.492em); top: -3.229em; left: 50%; margin-left: -0.672em;"><span class="mfrac" id="MathJax-Span-566"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.524em 1000em 2.361em -0.471em); top: -2.536em; left: 50%; margin-left: -0.492em;"><span class="mrow" id="MathJax-Span-567"><span class="msubsup" id="MathJax-Span-568"><span style="display: inline-block; position: relative; width: 0.639em; height: 0px;"><span style="position: absolute; clip: rect(1.664em 1000em 2.361em -0.471em); top: -2.186em; left: 0em;"><span class="mi" id="MathJax-Span-569" style="font-size: 50%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span><span style="position: absolute; top: -2.35em; left: 0.328em;"><span class="mn" id="MathJax-Span-570" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span><span class="mi" id="MathJax-Span-571" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span><span style="position: absolute; clip: rect(1.529em 1000em 2.361em -0.471em); top: -1.708em; left: 50%; margin-left: -0.437em;"><span class="mrow" id="MathJax-Span-572"><span class="mi" id="MathJax-Span-573" style="font-size: 50%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="msubsup" id="MathJax-Span-574"><span style="display: inline-block; position: relative; width: 0.584em; height: 0px;"><span style="position: absolute; clip: rect(1.669em 1000em 2.355em -0.474em); top: -2.186em; left: 0em;"><span class="mi" id="MathJax-Span-575" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span><span style="position: absolute; top: -2.345em; left: 0.273em;"><span class="mn" id="MathJax-Span-576" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.24em; left: 0em;"><span style="border-left-width: 1.104em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.464em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.456em; vertical-align: -1.591em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-51"> \frac{\frac{\partial J}{\partial \theta}}{\frac{\partial^2 J}{\partial \theta^2}} </script></span> 라고 생각한 후, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-52-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-577" style="width: 5.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.372em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.588em 1000em 4.091em -0.492em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-578"><span class="mfrac" id="MathJax-Span-579"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.715em 1000em 2.514em -0.433em); top: -2.762em; left: 50%; margin-left: -0.191em;"><span class="mn" id="MathJax-Span-580" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span><span style="position: absolute; clip: rect(2.977em 1000em 4.642em -0.492em); top: -3.229em; left: 50%; margin-left: -0.672em;"><span class="mfrac" id="MathJax-Span-581"><span style="display: inline-block; position: relative; width: 1.104em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.524em 1000em 2.361em -0.471em); top: -2.536em; left: 50%; margin-left: -0.492em;"><span class="mrow" id="MathJax-Span-582"><span class="msubsup" id="MathJax-Span-583"><span style="display: inline-block; position: relative; width: 0.639em; height: 0px;"><span style="position: absolute; clip: rect(1.664em 1000em 2.361em -0.471em); top: -2.186em; left: 0em;"><span class="mi" id="MathJax-Span-584" style="font-size: 50%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span><span style="position: absolute; top: -2.35em; left: 0.328em;"><span class="mn" id="MathJax-Span-585" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span><span class="mi" id="MathJax-Span-586" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span><span style="position: absolute; clip: rect(1.529em 1000em 2.361em -0.471em); top: -1.708em; left: 50%; margin-left: -0.437em;"><span class="mrow" id="MathJax-Span-587"><span class="mi" id="MathJax-Span-588" style="font-size: 50%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="msubsup" id="MathJax-Span-589"><span style="display: inline-block; position: relative; width: 0.584em; height: 0px;"><span style="position: absolute; clip: rect(1.669em 1000em 2.355em -0.474em); top: -2.186em; left: 0em;"><span class="mi" id="MathJax-Span-590" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span><span style="position: absolute; top: -2.345em; left: 0.273em;"><span class="mn" id="MathJax-Span-591" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.24em; left: 0em;"><span style="border-left-width: 1.104em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.464em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="mo" id="MathJax-Span-592" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-593" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.68em 1000em 2.521em -0.459em); top: -2.769em; left: 50%; margin-left: -0.464em;"><span class="mrow" id="MathJax-Span-594"><span class="mi" id="MathJax-Span-595" style="font-size: 70.7%; font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-596" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span><span style="position: absolute; clip: rect(3.117em 1000em 4.507em -0.492em); top: -3.369em; left: 50%; margin-left: -0.481em;"><span class="mfrac" id="MathJax-Span-597"><span style="display: inline-block; position: relative; width: 0.721em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.664em 1000em 2.361em -0.471em); top: -2.536em; left: 50%; margin-left: -0.301em;"><span class="mrow" id="MathJax-Span-598"><span class="mi" id="MathJax-Span-599" style="font-size: 50%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mi" id="MathJax-Span-600" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span><span style="position: absolute; clip: rect(1.664em 1000em 2.361em -0.471em); top: -1.843em; left: 50%; margin-left: -0.273em;"><span class="mrow" id="MathJax-Span-601"><span class="mi" id="MathJax-Span-602" style="font-size: 50%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mi" id="MathJax-Span-603" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.24em; left: 0em;"><span style="border-left-width: 0.721em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 1.081em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.787em; vertical-align: -1.591em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-52"> \frac{1}{\frac{\partial^2 J}{\partial \theta^2}} = \frac{\Delta \theta}{\frac{\partial J}{\partial \theta}}</script></span> 이므로 이를 분자의 Root Mean Square, 분모의 Root Mean Square 값의 비율로 근사한 것이다. 더욱 자세한 설명을 원하시는 분은 논문을 직접 읽어보시길 바란다.</p><h2 id="adam"><a name="adam" href="#adam"></a>Adam</h2><p>Adam (Adaptive Moment Estimation)은 RMSProp과 Momentum 방식을 합친 것 같은 알고리즘이다. 이 방식에서는 Momentum 방식과 유사하게 지금까지 계산해온 기울기의 지수평균을 저장하며, RMSProp과 유사하게 기울기의 제곱값의 지수평균을 저장한다.</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-69-Frame"><nobr><span class="math" id="MathJax-Span-907" style="width: 16.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.88em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.471em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-908"><span class="msubsup" id="MathJax-Span-909"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(1.853em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-910" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.929em;"><span class="mi" id="MathJax-Span-911" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-912" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-913" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.817em -0.469em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-914" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.12em; left: 0.594em;"><span class="mn" id="MathJax-Span-915" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-916"><span style="display: inline-block; position: relative; width: 2.206em; height: 0px;"><span style="position: absolute; clip: rect(1.853em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-917" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.929em;"><span class="texatom" id="MathJax-Span-918"><span class="mrow" id="MathJax-Span-919"><span class="mi" id="MathJax-Span-920" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-921" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-922" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span><span class="mo" id="MathJax-Span-923" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-924" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-925" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-926" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-927" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.817em -0.469em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-928" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.12em; left: 0.594em;"><span class="mn" id="MathJax-Span-929" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span><span class="mo" id="MathJax-Span-930" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-931"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.831em 1000em 2.875em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-932" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="mi" id="MathJax-Span-933" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-934" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-935" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-936" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-937" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-69">m_t = \beta_1 m_{t-1} + (1-\beta_1)\nabla_\theta J(\theta)</script><p></p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-77-Frame"><nobr><span class="math" id="MathJax-Span-1158" style="width: 17.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.262em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.566em 1000em 3.092em -0.471em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-1159"><span class="msubsup" id="MathJax-Span-1160"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-1161" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-1162" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-1163" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1164" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.817em -0.469em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-1165" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.12em; left: 0.594em;"><span class="mn" id="MathJax-Span-1166" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1167"><span style="display: inline-block; position: relative; width: 1.769em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-1168" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.2em; left: 0.492em;"><span class="texatom" id="MathJax-Span-1169"><span class="mrow" id="MathJax-Span-1170"><span class="mi" id="MathJax-Span-1171" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-1172" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1173" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span><span class="mo" id="MathJax-Span-1174" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-1175" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-1176" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1177" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-1178" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.817em -0.469em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-1179" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.12em; left: 0.594em;"><span class="mn" id="MathJax-Span-1180" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span><span class="mo" id="MathJax-Span-1181" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1182" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1183"><span style="display: inline-block; position: relative; width: 1.332em; height: 0px;"><span style="position: absolute; clip: rect(1.831em 1000em 2.875em -0.446em); top: -2.678em; left: 0em;"><span class="mi" id="MathJax-Span-1184" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.141em; left: 0.874em;"><span class="mi" id="MathJax-Span-1185" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mi" id="MathJax-Span-1186" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-1187" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1188" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-1189" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-1190"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(1.764em 1000em 3.092em -0.437em); top: -2.678em; left: 0em;"><span class="mo" id="MathJax-Span-1191" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.827em; left: 0.437em;"><span class="mn" id="MathJax-Span-1192" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.595em; vertical-align: -0.372em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-77">v_t = \beta_2 v_{t-1} + (1-\beta_2)(\nabla_\theta J(\theta))^2</script><p></p><p>다만, Adam에서는 m과 v가 처음에 0으로 초기화되어 있기 때문에 학습의 초반부에서는 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-486-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-3744" style="width: 3.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.568em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.071em 1000em 3.036em -0.471em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-3745"><span class="msubsup" id="MathJax-Span-3746"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(1.853em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-3747" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.929em;"><span class="mi" id="MathJax-Span-3748" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span class="mo" id="MathJax-Span-3749" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-3750" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-3751" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-3752" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.91em; vertical-align: -0.303em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-486">m_t, v_t</script></span>가 0에 가깝게 bias 되어있을 것이라고 판단하여 이를 unbiased 하게 만들어주는 작업을 거친다. <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-487-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-3753" style="width: 1.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.311em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.58em 1000em 2.508em -0.471em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-3754"><span class="msubsup" id="MathJax-Span-3755"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(1.853em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-3756" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.929em;"><span class="mi" id="MathJax-Span-3757" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.865em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-487"> m_t</script></span> 와 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-488-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-3758" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.579em 1000em 2.508em -0.471em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-3759"><span class="msubsup" id="MathJax-Span-3760"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-3761" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-3762" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.866em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-488">v_t</script></span>의 식을 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-489-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-3763" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.818em 1000em 3.146em -0.436em); top: -2.732em; left: 0em;"><span class="mrow" id="MathJax-Span-3764"><span class="mo" id="MathJax-Span-3765" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span></span><span style="display: inline-block; width: 0px; height: 2.732em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.372em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-489"> \sum </script></span> 형태로 펼친 후 양변에 expectation을 씌워서 정리해보면, 다음과 같은 보정을 통해 unbiased 된 expectation을 얻을 수 있다. 이 보정된 expectation들을 가지고 gradient가 들어갈 자리에 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-490-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-3766" style="width: 1.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.311em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.28em 1000em 2.508em -0.471em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-3767"><span class="texatom" id="MathJax-Span-3768"><span class="mrow" id="MathJax-Span-3769"><span class="munderover" id="MathJax-Span-3770"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.383em 1000em 4.311em -0.471em); top: -3.989em; left: 0em;"><span class="msubsup" id="MathJax-Span-3771"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(1.853em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-3772" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.929em;"><span class="mi" id="MathJax-Span-3773" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(1.82em 1000em 2.311em -0.38em); top: -2.725em; left: 0.365em;"><span class="mo" id="MathJax-Span-3774" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.231em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-490">\hat{m_t} </script></span>, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-491-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-3775" style="width: 1.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.202em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.508em -0.442em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-3776"><span class="msubsup" id="MathJax-Span-3777"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.645em -0.442em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-3778" style="font-family: MathJax_Math; font-style: italic;">G</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.82em;"><span class="mi" id="MathJax-Span-3779" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.186em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-491">G_t</script></span>가 들어갈 자리에 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-492-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-3780" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.874em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.279em 1000em 2.508em -0.471em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-3781"><span class="texatom" id="MathJax-Span-3782"><span class="mrow" id="MathJax-Span-3783"><span class="munderover" id="MathJax-Span-3784"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(3.382em 1000em 4.311em -0.471em); top: -3.989em; left: 0em;"><span class="msubsup" id="MathJax-Span-3785"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-3786" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-3787" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(1.82em 1000em 2.311em -0.38em); top: -2.726em; left: 0.147em;"><span class="mo" id="MathJax-Span-3788" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.232em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-492">\hat{v_t}</script></span>를 넣어 계산을 진행한다.</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-592-Frame"><nobr><span class="math" id="MathJax-Span-4369" style="width: 7.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.792em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.395em 1000em 3.94em -0.471em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-4370"><span class="texatom" id="MathJax-Span-4371"><span class="mrow" id="MathJax-Span-4372"><span class="munderover" id="MathJax-Span-4373"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.383em 1000em 4.311em -0.471em); top: -3.989em; left: 0em;"><span class="msubsup" id="MathJax-Span-4374"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(1.853em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-4375" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.929em;"><span class="mi" id="MathJax-Span-4376" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(1.82em 1000em 2.311em -0.38em); top: -2.725em; left: 0.365em;"><span class="mo" id="MathJax-Span-4377" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-4378" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-4379" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.907em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.383em 1000em 4.311em -0.471em); top: -4.666em; left: 50%; margin-left: -0.639em;"><span class="msubsup" id="MathJax-Span-4380"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(1.853em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-4381" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.929em;"><span class="mi" id="MathJax-Span-4382" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(1.639em 1000em 3.089em -0.409em); top: -1.826em; left: 50%; margin-left: -1.393em;"><span class="mrow" id="MathJax-Span-4383"><span class="mn" id="MathJax-Span-4384" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-4385" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-4386" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.817em -0.469em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-4387" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; clip: rect(1.688em 1000em 2.467em -0.478em); top: -2.727em; left: 0.653em;"><span class="mi" id="MathJax-Span-4388" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.715em 1000em 2.514em -0.433em); top: -2.103em; left: 0.594em;"><span class="mn" id="MathJax-Span-4389" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.907em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.838em; vertical-align: -1.407em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-592">\hat{m_t} = \frac{m_t}{1-\beta_1^t}</script><p></p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-593-Frame"><nobr><span class="math" id="MathJax-Span-4390" style="width: 6.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.355em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.394em 1000em 3.94em -0.471em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-4391"><span class="texatom" id="MathJax-Span-4392"><span class="mrow" id="MathJax-Span-4393"><span class="munderover" id="MathJax-Span-4394"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(3.382em 1000em 4.311em -0.471em); top: -3.989em; left: 0em;"><span class="msubsup" id="MathJax-Span-4395"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-4396" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-4397" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(1.82em 1000em 2.311em -0.38em); top: -2.726em; left: 0.147em;"><span class="mo" id="MathJax-Span-4398" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-4399" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-4400" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.907em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.382em 1000em 4.311em -0.471em); top: -4.666em; left: 50%; margin-left: -0.42em;"><span class="msubsup" id="MathJax-Span-4401"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-4402" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-4403" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(1.639em 1000em 3.089em -0.409em); top: -1.826em; left: 50%; margin-left: -1.393em;"><span class="mrow" id="MathJax-Span-4404"><span class="mn" id="MathJax-Span-4405" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-4406" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-4407" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.817em -0.469em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-4408" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; clip: rect(1.688em 1000em 2.467em -0.478em); top: -2.727em; left: 0.653em;"><span class="mi" id="MathJax-Span-4409" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span><span style="position: absolute; clip: rect(1.715em 1000em 2.514em -0.456em); top: -2.103em; left: 0.594em;"><span class="mn" id="MathJax-Span-4410" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 2.907em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.839em; vertical-align: -1.407em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-593">\hat{v_t} = \frac{v_t}{1-\beta_2^t}</script><p></p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-678-Frame"><nobr><span class="math" id="MathJax-Span-4852" style="width: 10.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.798em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.379em 1000em 4.028em -0.457em); top: -2.678em; left: 0em;"><span class="mrow" id="MathJax-Span-4853"><span class="mi" id="MathJax-Span-4854" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-4855" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-4856" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">θ</span><span class="mo" id="MathJax-Span-4857" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mfrac" id="MathJax-Span-4858" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 3.642em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.853em 1000em 2.839em -0.471em); top: -3.152em; left: 50%; margin-left: -0.273em;"><span class="mi" id="MathJax-Span-4859" style="font-family: MathJax_Math; font-style: italic;">η<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; clip: rect(2.914em 1000em 4.452em -0.381em); top: -3.101em; left: 50%; margin-left: -1.761em;"><span class="msqrt" id="MathJax-Span-4860"><span style="display: inline-block; position: relative; width: 3.522em; height: 0px;"><span style="position: absolute; clip: rect(1.771em 1000em 2.999em -0.471em); top: -2.678em; left: 0.984em;"><span class="mrow" id="MathJax-Span-4861"><span class="texatom" id="MathJax-Span-4862"><span class="mrow" id="MathJax-Span-4863"><span class="munderover" id="MathJax-Span-4864"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(3.382em 1000em 4.311em -0.471em); top: -3.989em; left: 0em;"><span class="msubsup" id="MathJax-Span-4865"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px;"><span style="position: absolute; clip: rect(1.852em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-4866" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.492em;"><span class="mi" id="MathJax-Span-4867" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(1.82em 1000em 2.311em -0.38em); top: -2.726em; left: 0.147em;"><span class="mo" id="MathJax-Span-4868" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-4869" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-4870" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; clip: rect(3.555em 1000em 4.023em -0.492em); top: -4.63em; left: 0.984em;"><span style="display: inline-block; position: relative; width: 2.539em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.989em; left: 1.845em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 0.379em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 0.868em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.989em; left: 1.356em;">−<span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(2.975em 1000em 4.503em -0.381em); top: -4.04em; left: 0em;"><span style="font-family: MathJax_Size1;">√</span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(0.861em 1000em 1.257em -0.492em); top: -1.313em; left: 0em;"><span style="border-left-width: 3.642em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.093em;"></span></span></span></span><span class="texatom" id="MathJax-Span-4871" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-4872"><span class="munderover" id="MathJax-Span-4873"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.383em 1000em 4.311em -0.471em); top: -3.989em; left: 0em;"><span class="msubsup" id="MathJax-Span-4874"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(1.853em 1000em 2.634em -0.471em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-4875" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.145em; left: 0.929em;"><span class="mi" id="MathJax-Span-4876" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.295em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.989em;"></span></span><span style="position: absolute; clip: rect(1.82em 1000em 2.311em -0.38em); top: -2.725em; left: 0.365em;"><span class="mo" id="MathJax-Span-4877" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.965em; vertical-align: -1.514em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-678">\theta = \theta - \frac{\eta}{\sqrt{\hat{v_t}+\epsilon}}\hat{m_t}</script><p></p><p>보통 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-679-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-4878" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.579em -0.469em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-4879"><span class="msubsup" id="MathJax-Span-4880"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.817em -0.469em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-4881" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.12em; left: 0.594em;"><span class="mn" id="MathJax-Span-4882" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.273em; vertical-align: -0.346em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-679">\beta_1</script></span> 로는 0.9, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-680-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-4883" style="width: 1.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.317em 1000em 2.579em -0.469em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-4884"><span class="msubsup" id="MathJax-Span-4885"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px;"><span style="position: absolute; clip: rect(1.59em 1000em 2.817em -0.469em); top: -2.459em; left: 0em;"><span class="mi" id="MathJax-Span-4886" style="font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span><span style="position: absolute; top: -2.12em; left: 0.594em;"><span class="mn" id="MathJax-Span-4887" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.273em; vertical-align: -0.346em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-680">\beta_2</script></span>로는 0.999, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-681-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-4888" style="width: 0.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.864em 1000em 2.634em -0.452em); top: -2.459em; left: 0em;"><span class="mrow" id="MathJax-Span-4889"><span class="mi" id="MathJax-Span-4890" style="font-family: MathJax_Math; font-style: italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.459em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.673em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-681">\epsilon</script></span> 으로는 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-682-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-4891" style="width: 2.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.077em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.158em 1000em 2.372em -0.409em); top: -2.186em; left: 0em;"><span class="mrow" id="MathJax-Span-4892"><span class="msubsup" id="MathJax-Span-4893"><span style="display: inline-block; position: relative; width: 2.042em; height: 0px;"><span style="position: absolute; clip: rect(1.848em 1000em 2.864em -0.409em); top: -2.678em; left: 0em;"><span class="mn" id="MathJax-Span-4894" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.678em;"></span></span><span style="position: absolute; top: -2.743em; left: 1.038em;"><span class="texatom" id="MathJax-Span-4895"><span class="mrow" id="MathJax-Span-4896"><span class="mo" id="MathJax-Span-4897" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-4898" style="font-size: 70.7%; font-family: MathJax_Main;">8</span></span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.186em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.214em; vertical-align: -0.094em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-682">10^{-8}</script></span> 정도의 값을 사용한다고 한다.</p><h2 id="summing-up"><a name="summing-up" href="#summing-up"></a>Summing up</h2><p>지금까지 다양한 Gradient Descent 알고리즘의 변형 알고리즘들을 알아보았다. Momentum, NAG, AdaGrad, AdaDelta, RMSProp, Adam 등 다양한 알고리즘들이 있었지만 이 중에서 어느 알고리즘이 가장 좋다, 라고 말하기는 힘들다. 어떤 문제를 풀고있는지, 어떤 데이터셋을 사용하는지, 어떤 네트워크에 대해 적용하는지에 따라 각 방법의 성능은 판이하게 차이가 날 것이므로 실제로 네트워크를 학습시킬 때는 다양한 시도를 해보며 현재 경우에서는 어떤 알고리즘이 가장 성능이 좋은지에 대해 실험해볼 필요가 있다. 다행히, Tensorflow 등의 Machine learning library를 사용하면 코드 한 줄만 변화시키면 쉽게 어떤 optimizer를 사용할 것인지 설정해줄 수 있어 간편하게 실험해볼 수 있을 것이다.</p><p>여기서 설명한 알고리즘들은 모두 Stochastic Gradient Descent, 즉 단순한 first-order optimization의 변형들이다. 이 외에도 Newton’s Method 등 second-order optimization을 기반으로 한 알고리즘들도 있다. 그러나 단순한 second-order optimization을 사용하기 위해서는 Hessian Matrix라는 2차 편미분 행렬을 계산한 후 역행렬을 구해야 하는데, 이 계산과정이 계산적으로 비싼 작업이기 때문에 보통 잘 사용되지 않는다. 이러한 계산량을 줄이기 위해 hessian matrix를 근사하거나 추정해나가면서 계산을 진행하는 BFGS / L-BFGS 등의 알고리즘, 그리고 hessian matrix를 직접 계산하지 않으면서 second-order optimization인 Hessian-Free Optimization 등도 존재한다. 이러한 부분들에 대해서는 나중에 기회가 되면 공부해서 언급해보도록 하겠다.</p>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
